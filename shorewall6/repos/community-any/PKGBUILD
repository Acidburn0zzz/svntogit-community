# $Id$
# Contributor: Andrea Scarpino <andrea@archlinux.org>

pkgname=shorewall6
pkgver=4.4.5
pkgrel=1
pkgdesc="IPv6 support for Shorewall"
arch=('any')
url="http://www.shorewall.net"
backup=(etc/shorewall6/{shorewall6.conf,zones,functions,policy,interfaces,ipsec,hosts,rules,nat,netmap,params,proxyarp,routestopped,maclist,masq,modules,tcclasses,tcdevices,tcfilters,tcrules,whitelist})
license=('GPL')
depends=('bash' 'shorewall')
source=(http://downloads.sourceforge.net/shorewall/$pkgname-$pkgver.tar.bz2)
md5sums=('5d7b02fd14c0e14698661aa37b3323f7')

build() {
  cd ${srcdir}/$pkgname-$pkgver
 
  sed -e 's!LOGFILE=/var/log/messages!LOGFILE=/var/log/messages.log!' -i shorewall6.conf
  sed -e 's!LOGFILE=/var/log/messages!LOGFILE=/var/log/messages.log!' -i shorewall6

  mv init.archlinux.sh init.sh
  DEST=/etc/rc.d INIT=shorewall6 PREFIX=${pkgdir} ./install.sh
  cp -rv ${srcdir}/$pkgname-$pkgver/Samples6 ${pkgdir}/usr/share/shorewall6

  sed -e 's!/subsys!!' -i ${pkgdir}/etc/shorewall6/shorewall6.conf

  for file in ${pkgdir}/etc/shorewall6/*; do
    chmod 644 ${pkgdir}/etc/shorewall6/$(basename $file)
  done
  chmod 644 ${pkgdir}/usr/share/shorewall6/modules
}
