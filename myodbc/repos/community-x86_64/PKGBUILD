# $Id$
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>

pkgname=myodbc
pkgver=5.1.8
pkgrel=2
pkgdesc="ODBC driver/connector for MySQL"
arch=(i686 x86_64)
url="http://dev.mysql.com/downloads/connector/odbc/"
depends=('unixodbc' 'libmysqlclient')
license=('GPL')
source=("http://mysql.cce.usp.br/Downloads/Connector-ODBC/5.1/mysql-connector-odbc-${pkgver}.tar.gz"
	myodbc-64bit.patch
	myodbc-add-mysys.patch
	myodbc-my-free.patch
	myodbc-shutdown.patch)
md5sums=('c64d8cec9de453bdf48fcb168643b943'
         '142a985fa0d3273df04399148ef27533'
         '8d019f9b6a10a6a56d835e7e4e22d215'
         '2d1636160af606323014b112c9481cf2'
         'ec43ad7b5c887a7de4b6024899ff886c')

build() {
  cd $srcdir/mysql-connector-odbc-${pkgver}
  [ $NOEXTRACT -eq 1 ] || patch -p1 <$srcdir/myodbc-64bit.patch
  [ $NOEXTRACT -eq 1 ] || patch -p1 <$srcdir/myodbc-add-mysys.patch
  [ $NOEXTRACT -eq 1 ] || patch -p1 <$srcdir/myodbc-my-free.patch
  [ $NOEXTRACT -eq 1 ] || patch -p1 <$srcdir/myodbc-shutdown.patch
  [ -f Makefile ] || CFLAGS="$CFLAGS -DTHREAD" \
	./configure --prefix=/usr --sysconfdir=/etc --with-unixODBC=/usr --with-odbc-ini=/etc/odbc.ini \
		--with-mysql-path=/usr --without-x --disable-gui --disable-test
  make
}

package() {
  cd $srcdir/mysql-connector-odbc-${pkgver}
  make DESTDIR=$pkgdir install
}
