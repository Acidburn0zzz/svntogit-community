# Maintainer: Eli Schwartz <eschwartz@archlinux.org>

pkgname=exploitdb
_pkgver=2018-10-31
pkgver=${_pkgver//-/}
pkgrel=1
pkgdesc="Offensive Securityâ€™s Exploit Database Archive"
arch=('any')
url="https://www.exploit-db.com/"
license=('GPL')
optdepends=('libxml2: to check nmap XML results'
            'xclip: copy paths to the clipboard')
backup=('etc/searchsploit_rc')
options=('!strip')
source=("${pkgname}-${_pkgver}.tar.gz::https://github.com/offensive-security/${pkgname}/archive/${_pkgver}.tar.gz"
        "rcfile.diff")
sha512sums=('c41f15d90d3db801225f0067c3ad098b4be144cabbd21d2cfb3cbff01fa58ef4cb1931901200410ac6866b4a6149d31ba0f904b66067bae8147b987817e0ae3b'
            'e170da5b974975c6c23c5b09e8c1825bbb17446fb506f2d00f92f86f94394acf18a53458bd90969de38da642fc1f7abb08ba940969108002dab17415b88211d6')

prepare() {
    cd ${pkgname}-${_pkgver}

    patch -p1 -i ../rcfile.diff
}

package() {
    cd ${pkgname}-${_pkgver}

    install -Dm755 searchsploit "${pkgdir}"/usr/bin/searchsploit
    install -Dm644 .searchsploit_rc "${pkgdir}"/etc/searchsploit_rc
    mkdir -p "${pkgdir}"/usr/share/${pkgname}
    cp -a exploits/ shellcodes/ files_*.csv "${pkgdir}"/usr/share/${pkgname}
}
