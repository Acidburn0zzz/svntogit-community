# $Id$
# Maintainer: Allan McRae <allan@archlinux.org>

pkgname=pacman-contrib
pkgver=4.0.2
pkgrel=2
pkgdesc="Utilities for use with the pacman package manager"
arch=('any')
url="http://www.archlinux.org/pacman/"
license=('GPL')
depends=('pacman')
source=(ftp://ftp.archlinux.org/other/pacman/pacman-$pkgver.tar.gz{,.sig})
md5sums=('289ba4a19a16393096e065cec1cb9b0a'
         '575140dce3ea597d91b6d081aa3f6a00')

_scripts=(
  bacman
  paccache
  pacdiff
  paclist
  paclog-pkglist
  pacscripts
  pacsearch
  pacsysclean
)

build() {
  cd "$srcdir/pacman-$pkgver"

  ./configure --prefix=/usr --sysconfdir=/etc \
    --localstatedir=/var --enable-doc

  make -C contrib
}

package() {
  cd "$srcdir/pacman-$pkgver/contrib"

  install -dm755 "$pkgdir/usr/bin" "$pkgdir/usr/share/vim/vimfiles/ftdetect"

  install -m755 -t "$pkgdir/usr/bin" "${_scripts[@]}"

  install -Dm644 PKGBUILD.vim "$pkgdir/usr/share/vim/vimfiles/syntax/PKGBUILD.vim"
  echo "au BufNewFile,BufRead PKGBUILD set filetype=PKGBUILD" \
    > "$pkgdir/usr/share/vim/vimfiles/ftdetect/PKGBUILD.vim"
}
