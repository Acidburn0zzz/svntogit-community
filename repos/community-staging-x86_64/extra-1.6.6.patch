From b3ef6ca4f59fb5854e42fe844c9593f6832ebd25 Mon Sep 17 00:00:00 2001
From: Neil Mitchell <ndmitchell@gmail.com>
Date: Fri, 13 Apr 2018 19:06:26 +0100
Subject: [PATCH] Require extra-1.6.6, so I can use escape/unescape HTML

---
 CHANGES.txt         |  1 +
 hoogle.cabal        |  2 +-
 src/General/Util.hs | 20 --------------------
 3 files changed, 2 insertions(+), 21 deletions(-)

diff --git a/src/General/Util.hs b/src/General/Util.hs
index 2f51c644..abfe89ec 100755
--- a/src/General/Util.hs
+++ b/src/General/Util.hs
@@ -200,26 +200,6 @@ tarballReadFiles file = f . Tar.read . GZip.decompress <$> LBS.readFile file
         f (Fail e) = error $ "tarballReadFiles on " ++ file ++ ", " ++ show e
 
 
--- | Take a piece of text and escape all the HTML special bits
-escapeHTML :: String -> String
-escapeHTML = concatMap f
-    where
-        f '<' = "&lt;"
-        f '>' = "&gt;"
-        f '&' = "&amp;"
-        f '\"' = "&quot;"
-        f  x  = [x]
-
--- | Only guarantees to be the inverse of escapeHTML
-unescapeHTML :: String -> String
-unescapeHTML ('&':xs)
-    | Just xs <- stripPrefix "lt;" xs = '<' : unescapeHTML xs
-    | Just xs <- stripPrefix "gt;" xs = '>' : unescapeHTML xs
-    | Just xs <- stripPrefix "amp;" xs = '&' : unescapeHTML xs
-    | Just xs <- stripPrefix "quot;" xs = '\"' : unescapeHTML xs
-unescapeHTML (x:xs) = x : unescapeHTML xs
-unescapeHTML [] = []
-
 innerTextHTML :: String -> String
 innerTextHTML ('<':xs) = innerTextHTML $ drop 1 $ dropWhile (/= '>') xs
 innerTextHTML (x:xs) = x : innerTextHTML xs
