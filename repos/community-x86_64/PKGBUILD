# $Id$
# Contributor: Tom Newsom <Jeepster@gmx.co.uk>
# Contributor: Jeff Mickey <jeff@archlinux.org>
# Contributor: Thayer Williams <thayer@archlinux.org>
# Maintainer: schuay <jakob.gruber@gmail.com

pkgname=dopewars
pkgver=1.5.12
pkgrel=9
pkgdesc="A drug dealing game set in New York"
url="http://dopewars.sourceforge.net/"
license=('GPL')
arch=('x86_64')
depends=('gtk2' 'alsa-lib' 'audiofile' 'sdl_mixer' 'ncurses')
install='dopewars.install'
source=("http://downloads.sourceforge.net/$pkgname/$pkgname-$pkgver.tar.gz")
sha512sums=('cfabaf9326c847aed6210a852ace64c697df5845a66b3179b8dc8dea7b99a11e1f91358d4ee54929a56c70d5f3a76f9f7bb4079fdef765601f165b4cd06cba5a')

build() {
    cd "$srcdir/$pkgname-$pkgver"

    ./configure --prefix=/usr --localstatedir=/var/games \
        --mandir=/usr/share/man
    make
}

package() {
    cd "$srcdir/$pkgname-$pkgver"

    make DESTDIR="$pkgdir" install

    # setup shortcut menu entries
    mkdir -p "$pkgdir/usr/share/applications"
    mv "$pkgdir/usr/share/gnome/apps/Games/dopewars.desktop" \
       "$pkgdir/usr/share/applications"
    rm -r "$pkgdir/usr/share/gnome"

    # set appropriate permissions and destinations
    chown root:games "$pkgdir/usr/bin/dopewars"
    chmod 2755 "$pkgdir/usr/bin/dopewars"
    chown root:games "$pkgdir/var/games"
    chmod 775 "$pkgdir/var/games"

    # Handle the scores file creation in the install script
    rm "$pkgdir/var/games/dopewars.sco"
}

