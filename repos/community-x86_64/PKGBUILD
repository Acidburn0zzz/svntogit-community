# Maintainer: David Runge <dave@sleepmap.de>

pkgname=cage
pkgver=0.1
pkgrel=3
pkgdesc="A kiosk compositor for Wayland"
arch=('x86_64')
url="https://www.hjdskes.nl/projects/cage/"
license=('MIT')
depends=('wlroots')
makedepends=('meson' 'wayland-protocols' 'xorg-server-xwayland')
optdepends=('xorg-server-xwayland: X11 support')
source=("$pkgname-$pkgver.tar.gz::https://github.com/Hjdskes/${pkgname}/archive/v${pkgver}.tar.gz"
        "https://github.com/Hjdskes/cage/releases/download/v${pkgver}/${pkgname}-${pkgver}.tar.gz.sig")
noextract=()
sha512sums=('7c4c9d3374e05cb57d76db9d68e0919fcf6d64547d2a13f0698e4bd28d542a0ec0b96911eefda9c69dfb887ae11b91b77af19d340844642907acdd25dd1e5b4b'
            'SKIP')
validpgpkeys=('13B6A35E9FD677D02CD68DBE37C445296EBC43B1') # Jente Hidskes <dev@hjdskes.nl>

build() {
  cd "$pkgname-$pkgver"
  arch-meson --prefix=/usr \
             --libdir=lib \
             --buildtype=release \
             -Dxwayland=true \
             build
  ninja -C build
}

package() {
  cd "$pkgname-$pkgver"
  DESTDIR="${pkgdir}" meson install -C build
  #docs
  install -vDm 644 README.md \
    -t "${pkgdir}/usr/share/doc/${pkgname}"
  install -vDm 644 LICENSE \
    -t "${pkgdir}/usr/share/licenses/${pkgname}"
}
