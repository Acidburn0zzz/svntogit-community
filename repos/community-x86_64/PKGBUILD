# Contributor: Jaroslaw Swierczynski <swiergot@aur.archlinux.org>
# Contributor: Roman Kyrylych <Roman.Kyrylych@gmail.com>

pkgname=glob2
pkgver=0.9.3
pkgrel=2
pkgdesc="RTS game which minimizes micro-management by automatically assigning tasks to units"
arch=('i686' 'x86_64')
url="http://www.globulation2.org/"
license=('GPL3')
depends=('boost' 'sdl_net' 'sdl_image' 'sdl_ttf' 'libvorbis' 'speex' 'mesa' \
         'fribidi' 'desktop-file-utils')
makedepends=('scons')
install=glob2.install
source=(http://dl.sv.nongnu.org/releases/$pkgname/$pkgver/$pkgname-$pkgver.tar.gz \
	$pkgname-typeinfo.patch
	glob2-0.9.4.1-gcc44.patch)
md5sums=('e0483d5864cff4ace5ac8e39eae27429'
         '49bfd1a7137ae995565cbb3fe7f6c556'
	 'b13cb1f73ece23bfc6413773678d583e')

build() {
  cd $startdir/src/$pkgname-$pkgver
  patch -Np1 -i $startdir/src/$pkgname-typeinfo.patch || return 1
  patch -Np0 -i $srcdir/glob2-0.9.4.1-gcc44.patch || return 1
  scons BINDIR="$startdir/pkg/usr/bin" INSTALLDIR="$startdir/pkg/usr/share" || return 1
  scons install || return 1
  find $startdir/pkg/usr/share -type f -exec chmod 644 '{}' \;
  install -Dm644 data/icons/glob2-icon-48x48.png $startdir/pkg/usr/share/pixmaps/glob2-icon-48x48.png
}
