# Maintainer: David Runge <dave@sleepmap.de>
pkgname=zita-njbridge
pkgver=0.4.2
pkgrel=1
pkgdesc="Jack client to transmit audio over a local IP network."
arch=('x86_64')
url="https://kokkinizita.linuxaudio.org/linuxaudio/"
license=('GPL3')
groups=('pro-audio')
depends=('jack' 'zita-resampler')
source=("https://kokkinizita.linuxaudio.org/linuxaudio/downloads/${pkgname}-${pkgver}.tar.bz2")
sha512sums=('8970fb92cb012fbf4888b3c13eba3b38be32096c99010c1d2c2340fdb8c5c582940d03a5dc815c9f96b9c419c993be38fa3dda7ece958f382d4166b36fe53920')

prepare() {
  cd "${pkgname}-${pkgver}/source"
  # strip march=native
  sed -e '/native/d' -i Makefile
  # fix man installation
  sed -e 's/zita-j2n zita-n2j zita-njbridge.1.gz zita-j2n.1.gz zita-n2j.1.gz/zita-j2n zita-n2j/' \
      -e 's/zita-njbridge.1.gz/zita-njbridge.1 -t/g' \
      -e 's/zita-j2n.1.gz/zita-j2n.1 -t/g' \
      -e 's/zita-n2j.1.gz/zita-n2j.1 -t/g' -i Makefile
}

build() {
  cd "${pkgname}-${pkgver}/source"
  make PREFIX=/usr
}

package() {
  cd "${pkgname}-${pkgver}/source"
  make PREFIX=/usr DESTDIR="$pkgdir" install
  # docs
  install -t "${pkgdir}/usr/share/doc/${pkgname}" \
    -vDm 644 ../{AUTHORS,README}
}
# vim:set ts=2 sw=2 et:
