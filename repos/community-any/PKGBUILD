# Maintainer: Felix Yan <felixonmars@archlinux.org>

pkgbase=python-pycontracts
pkgname=(python-pycontracts python2-pycontracts)
pkgver=1.8.8
pkgrel=1
pkgdesc='Declare constraints on function parameters and return values'
arch=('any')
url="https://andreacensi.github.io/contracts"
license=('GPL')
makedepends=('python-setuptools' 'python2-setuptools' 'python-pyparsing' 'python2-pyparsing'
             'python-decorator' 'python2-decorator' 'python-six' 'python2-six' 'python-future'
             'python2-future')
checkdepends=('python-nose' 'python2-nose')
source=("https://pypi.io/packages/source/P/PyContracts/PyContracts-$pkgver.tar.gz")
sha512sums=('8803afa6fb314d48c87d2707d87965cc5b6fde4ffd1497348f21c32ee229e9d6c0a63b93f5cd00c94230e30fdfce4a4a04a5e23a00173e1a2c0e53e437031baf')

prepare() {
  cp -a PyContracts-$pkgver{,-py2}
}

build() {
  cd "$srcdir"/PyContracts-$pkgver
  python setup.py build

  cd "$srcdir"/PyContracts-$pkgver-py2
  python2 setup.py build
}

check() {
  cd "$srcdir"/PyContracts-$pkgver
  python setup.py nosetests

  cd "$srcdir"/PyContracts-$pkgver-py2
  rm -r src/contracts-py3k-test
  python2 setup.py nosetests
}

package_python-pycontracts() {
  depends=('python-pyparsing' 'python-decorator' 'python-six' 'python-future')

  cd PyContracts-$pkgver
  python setup.py install --root="$pkgdir" --optimize=1
}

package_python2-pycontracts() {
  depends=('python2-pyparsing' 'python2-decorator' 'python2-six' 'python2-future')

  cd PyContracts-$pkgver-py2
  python2 setup.py install --root="$pkgdir" --optimize=1
}
