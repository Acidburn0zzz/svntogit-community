# $Id: PKGBUILD,v 1.4 2009/07/15 20:08:07 dgriffiths Exp $
# Maintainer: Mateusz Herych <heniekk@gmail.com>
# Contributor: Filippo 'JoeyrS' Civiletti <joeyrs@gmail.com>

pkgname=armagetronad
pkgver=0.3.0
pkgrel=2
pkgdesc="A Tron Clone in 3D."
arch=('i686' 'x86_64')
url="http://armagetronad.net/"
license=('GPL')
depends=('python' 'sdl_image' 'libxml2' 'sdl_mixer' 'mesa' 'ftgl')
source=(http://downloads.sourceforge.net/sourceforge/armagetronad/armagetronad-$pkgver.src.tar.gz
	gcc43.patch
	armagetronad.desktop)
md5sums=('2606c1e8ebadc01acf2d0398d302b447'
         '3877a4c5024a43887a2f410c784cfa1c'
	 'eda0c7342409fc76ceb5f77e03afd00b')

build()	{
	 cd $startdir/src/armagetronad-$pkgver
	 patch -p0 < ../gcc43.patch
	 sed -i 's|FTGL.h|ftgl.h|g' configure
	 ./configure --prefix=/usr \
	 	--sysconfdir=/etc/ \
		--mandir=/usr/share/man \
	       	--disable-games \
		--enable-automakedefaults
	 make || return 1
	 make DESTDIR=$startdir/pkg install
	 install -D -m 644 $startdir/armagetronad.desktop $startdir/pkg/usr/share/applications/armagetronad.desktop
	 rm -rf $startdir/pkg/usr/share/applnk
	 rm $startdir/pkg/usr/bin/armagetronad-uninstall
	 mv $startdir/pkg/usr/bin/armagetronad $startdir/pkg/usr/bin/armagetronad_bin
	 printf "#!/bin/bash\n/usr/bin/armagetronad_bin --configdir /etc/armagetronad --datadir /usr/share/armagetronad" > $startdir/pkg/usr/bin/armagetronad
	 chmod +x $startdir/pkg/usr/bin/armagetronad
}

