diff -upr mplayer-vaapi-20110127.orig/patches/mplayer-vaapi.patch mplayer-vaapi-20110127/patches/mplayer-vaapi.patch
--- mplayer-vaapi-20110127.orig/patches/mplayer-vaapi.patch	2011-01-27 17:15:29.000000000 +0200
+++ mplayer-vaapi-20110127/patches/mplayer-vaapi.patch	2011-03-05 06:47:20.000000000 +0200
@@ -449,14 +449,15 @@ diff --git a/fmt-conversion.c b/fmt-conv
 index 9e88100..bd32ce8 100644
 --- a/fmt-conversion.c
 +++ b/fmt-conversion.c
-@@ -18,12 +18,14 @@
+@@ -18,6 +18,7 @@
  
  #include "mp_msg.h"
  #include "libavutil/avutil.h"
 +#include "libavcodec/avcodec.h"
  #include "libmpcodecs/img_format.h"
- #include "fmt-conversion.h"
- 
+ #include "libavutil/samplefmt.h"
+ #include "libaf/af_format.h"
+@@ -26,6 +27,7 @@
  static const struct {
      int fmt;
      enum PixelFormat pix_fmt;
@@ -503,14 +504,15 @@ diff --git a/fmt-conversion.h b/fmt-conv
 index 9e133a8..962ca4e 100644
 --- a/fmt-conversion.h
 +++ b/fmt-conversion.h
-@@ -23,6 +23,6 @@
- #include "libavutil/avutil.h"
+@@ -24,7 +24,7 @@
+ #include "libavutil/samplefmt.h"
  
  enum PixelFormat imgfmt2pixfmt(int fmt);
 -int pixfmt2imgfmt(enum PixelFormat pix_fmt);
 +int pixfmt2imgfmt(enum PixelFormat pix_fmt, int codec_id);
+ enum AVSampleFormat affmt2samplefmt(int fmt);
+ int samplefmt2affmt(enum AVSampleFormat sample_fmt);
  
- #endif /* MPLAYER_FMT_CONVERSION_H */
 diff --git a/gui/mplayer/gtk/opts.c b/gui/mplayer/gtk/opts.c
 index 4f7ffb2..0da5434 100644
 --- a/gui/mplayer/gtk/opts.c
diff -upr mplayer-vaapi-20110127.orig/patches/mplayer-vdpau.patch mplayer-vaapi-20110127/patches/mplayer-vdpau.patch
--- mplayer-vaapi-20110127.orig/patches/mplayer-vdpau.patch	2010-11-15 08:41:19.000000000 +0200
+++ mplayer-vaapi-20110127/patches/mplayer-vdpau.patch	2011-03-05 07:07:15.000000000 +0200
@@ -133,7 +133,7 @@ index b0d00f4..745d3e4 100644
  
  videocodec ffh264
    info "FFmpeg H.264"
-@@ -993,19 +947,8 @@ videocodec ffh264
+@@ -993,21 +947,8 @@ videocodec ffh264
    driver ffmpeg
    dll h264
    out VAAPI_H264
@@ -146,6 +146,8 @@ index b0d00f4..745d3e4 100644
 -  fourcc X264,x264
 -  fourcc avc1,AVC1
 -  fourcc davc,DAVC
+-  fourcc ai55,ai15 ; flip4mac avc intra
+-  fourcc ai1q,ai5q ; flip4mac avc intra
 -  format 0x10000005
 -  driver ffmpeg
 -  dll h264_vdpau
@@ -362,13 +364,13 @@ index f99f7ea..faafa97 100644
                      context_count++;
              }
              break;
-@@ -3408,20 +3392,3 @@ AVCodec h264_decoder = {
+@@ -3408,21 +3392,3 @@ AVCodec h264_decoder = {
      .flush= flush_dpb,
      .long_name = NULL_IF_CONFIG_SMALL("H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10"),
  };
 -
 -#if CONFIG_H264_VDPAU_DECODER
--AVCodec h264_vdpau_decoder = {
+-AVCodec ff_h264_vdpau_decoder = {
 -    "h264_vdpau",
 -    AVMEDIA_TYPE_VIDEO,
 -    CODEC_ID_H264,
@@ -381,6 +383,7 @@ index f99f7ea..faafa97 100644
 -    .flush= flush_dpb,
 -    .long_name = NULL_IF_CONFIG_SMALL("H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10 (VDPAU acceleration)"),
 -    .pix_fmts = (const enum PixelFormat[]){PIX_FMT_VDPAU_H264, PIX_FMT_NONE},
+-    .profiles = NULL_IF_CONFIG_SMALL(profiles),
 -};
 -#endif
 diff --git a/ffmpeg/libavcodec/mpeg12.c b/ffmpeg/libavcodec/mpeg12.c
@@ -458,7 +461,7 @@ index 6a331eb..c226797 100644
  #endif
 -
 -#if CONFIG_MPEG_VDPAU_DECODER
--AVCodec mpeg_vdpau_decoder = {
+-AVCodec ff_mpeg_vdpau_decoder = {
 -    "mpegvideo_vdpau",
 -    AVMEDIA_TYPE_VIDEO,
 -    CODEC_ID_MPEG2VIDEO,
@@ -474,7 +477,7 @@ index 6a331eb..c226797 100644
 -#endif
 -
 -#if CONFIG_MPEG1_VDPAU_DECODER
--AVCodec mpeg1_vdpau_decoder = {
+-AVCodec ff_mpeg1_vdpau_decoder = {
 -    "mpeg1video_vdpau",
 -    AVMEDIA_TYPE_VIDEO,
 -    CODEC_ID_MPEG1VIDEO,
@@ -500,7 +503,7 @@ index b339f78..1928d03 100644
 -
 -
 -#if CONFIG_MPEG4_VDPAU_DECODER
--AVCodec mpeg4_vdpau_decoder = {
+-AVCodec ff_mpeg4_vdpau_decoder = {
 -    "mpeg4_vdpau",
 -    AVMEDIA_TYPE_VIDEO,
 -    CODEC_ID_MPEG4,
@@ -588,7 +591,7 @@ index c9a547b..71c50e7 100644
  #endif
 -
 -#if CONFIG_WMV3_VDPAU_DECODER
--AVCodec wmv3_vdpau_decoder = {
+-AVCodec ff_wmv3_vdpau_decoder = {
 -    "wmv3_vdpau",
 -    AVMEDIA_TYPE_VIDEO,
 -    CODEC_ID_WMV3,
@@ -605,7 +608,7 @@ index c9a547b..71c50e7 100644
 -#endif
 -
 -#if CONFIG_VC1_VDPAU_DECODER
--AVCodec vc1_vdpau_decoder = {
+-AVCodec ff_vc1_vdpau_decoder = {
 -    "vc1_vdpau",
 -    AVMEDIA_TYPE_VIDEO,
 -    CODEC_ID_VC1,
