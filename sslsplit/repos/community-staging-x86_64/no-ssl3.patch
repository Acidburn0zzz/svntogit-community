From: Hilko Bengen <bengen@debian.org>
Date: Sun, 22 Nov 2015 14:25:42 +0100
Subject: Use OPENSSL_NO_SSL3_METHOD to determine whether SSLv3_method is
 available

As suggested by Kurt Roeckx
---
 opts.c | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)

diff --git a/opts.c b/opts.c
index 0189af8..f23b357 100644
--- a/opts.c
+++ b/opts.c
@@ -143,11 +143,11 @@ opts_proto_force(opts_t *opts, const char *optarg, const char *argv0)
 		opts->sslmethod = SSLv2_method;
 	} else
 #endif /* SSL_OP_NO_SSLv2 && WITH_SSLV2 */
-#ifdef SSL_OP_NO_SSLv3
+#ifndef OPENSSL_NO_SSL3_METHOD
 	if (!strcmp(optarg, "ssl3")) {
 		opts->sslmethod = SSLv3_method;
 	} else
-#endif /* SSL_OP_NO_SSLv3 */
+#endif /* OPENSSL_NO_SSL3_METHOD */
 #ifdef SSL_OP_NO_TLSv1
 	if (!strcmp(optarg, "tls10") || !strcmp(optarg, "tls1")) {
 		opts->sslmethod = TLSv1_method;
@@ -182,11 +182,11 @@ opts_proto_disable(opts_t *opts, const char *optarg, const char *argv0)
 		opts->no_ssl2 = 1;
 	} else
 #endif /* SSL_OP_NO_SSLv2 && WITH_SSLV2 */
-#ifdef SSL_OP_NO_SSLv3
+#ifndef OPENSSL_NO_SSL3_METHOD
 	if (!strcmp(optarg, "ssl3")) {
 		opts->no_ssl3 = 1;
 	} else
-#endif /* SSL_OP_NO_SSLv3 */
+#endif /* OPENSSL_NO_SSL3_METHOD */
 #ifdef SSL_OP_NO_TLSv1
 	if (!strcmp(optarg, "tls10") || !strcmp(optarg, "tls1")) {
 		opts->no_tls10 = 1;
@@ -219,9 +219,9 @@ opts_proto_dbg_dump(opts_t *opts)
 #if defined(SSL_OP_NO_SSLv2) && defined(WITH_SSLV2)
 	               (opts->sslmethod == SSLv2_method) ? "nossl2" :
 #endif /* SSL_OP_NO_SSLv2 && WITH_SSLV2 */
-#ifdef SSL_OP_NO_SSLv3
+#ifndef OPENSSL_NO_SSL3_METHOD
 	               (opts->sslmethod == SSLv3_method) ? "ssl3" :
-#endif /* SSL_OP_NO_SSLv3 */
+#endif /* OPENSSL_NO_SSL3_METHOD */
 #ifdef SSL_OP_NO_TLSv1
 	               (opts->sslmethod == TLSv1_method) ? "tls10" :
 #endif /* SSL_OP_NO_TLSv1 */
@@ -236,9 +236,9 @@ opts_proto_dbg_dump(opts_t *opts)
 	               opts->no_ssl2 ? " -ssl2" :
 #endif /* SSL_OP_NO_SSLv2 && WITH_SSLV2 */
 	               "",
-#ifdef SSL_OP_NO_SSLv3
+#ifndef OPENSSL_NO_SSL3_METHOD
 	               opts->no_ssl3 ? " -ssl3" :
-#endif /* SSL_OP_NO_SSLv3 */
+#endif /* OPENSSL_NO_SSL3_METHOD */
 	               "",
 #ifdef SSL_OP_NO_TLSv1
 	               opts->no_tls10 ? " -tls10" :
