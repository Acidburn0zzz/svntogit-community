# Maintainer: Jelle van der Waa <jelle@vdwaa.nl>

pkgname=gsmartcontrol
pkgver=0.8.7
pkgrel=2
pkgdesc="A graphical user interface for the smartctl hard disk drive health inspection tool."
arch=('i686' 'x86_64')
url="http://gsmartcontrol.berlios.de/home/index.php/en/Home"
license=('GPL3')
depends=('smartmontools' 'pcre' 'gtkmm' 'libglademm' 'glib2' 'xorg-xmessage')
optdepends=('polkit: to run gsmartcontrol directly from menu')
install=${pkgname}.install
source=(http://download.berlios.de/gsmartcontrol/${pkgname}-${pkgver}.tar.bz2 org.archlinux.pkexec.gsmartcontrol.policy gsmartcontrol.desktop)
md5sums=('6d104c2ffc1e693cd1a8052a6d7e3b30'
         'e7b9380849cdcaa4356a42559ea7954f'
         '19b20293a639e51fa2abb929a3faae01')

build() {
	cd ${srcdir}/${pkgname}-${pkgver}
	./configure --prefix=/usr
	make 
}

check() {
	cd ${srcdir}/${pkgname}-${pkgver}
        make check
}

package() {
	cd ${srcdir}/${pkgname}-${pkgver}

	make DESTDIR=${pkgdir} install

        # Install pexec fixed desktop file
        install -Dm755 $srcdir/gsmartcontrol.desktop $pkgdir/usr/share/applications/gsmartcontrol.desktop

        # Install pexec file
        install -Dm766 $srcdir/org.archlinux.pkexec.gsmartcontrol.policy \
        $pkgdir/usr/share/polkit-1/actions/org.archlinux.pkexec.gsmartcontrol.policy 

      }
