# $Id: PKGBUILD,v 1.4 2009/04/09 09:51:54 sergej Exp $
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Maintainer: Eric Belanger <belanger@astro.umontreal.ca>
# Contributor: Hugo Ideler <hugoideler@dse.nl>
# Contributor: Zsolt Varadi <sysop_xxl@fibermail.hu>

pkgname=madman
pkgver=0.93
pkgrel=3
pkgdesc="I-tunes like music player"
arch=('i686' 'x86_64')
url="http://madman.sourceforge.net/"
license=('GPL')
depends=('qt' 'xmms' 'libid3tag' 'gtk')
makedepends=('python')
source=(http://downloads.sourceforge.net/sourceforge/madman/$pkgname-$pkgver.tar.gz \
        madman-0.93-gcc34.patch madman.desktop madman_logo.png \
	madman_logo_mini.png madman_logo_large.png)
md5sums=('a9aeef95248ecd55e0479a6b8dec43f2' '619eaa44f6cc47b3f9c27a0f4f7fb0f8'\
         '591354b69235d5a4b5a09591d04db266' 'd4546f77857a6ccdabb2036eb6a0da07'\
         '2d54bb8eceed283edc88a3e4553d2483' '3c2da1b1800fb372e225ae38fa1398e8')

build() {
  . /etc/profile.d/qt.sh
  cd $startdir/src/$pkgname-$pkgver
  tar xfz scons-local-0.95.tar.gz
  patch -p1 -i $startdir/src/madman-0.93-gcc34.patch
  touch designer/tsonglistview.h
  touch designer/tsetlistview.h

  ./scons.py || return 1
  ./scons.py prefix=$startdir/pkg/usr install || return 1

  rm $startdir/pkg/usr/bin/.sconsign
  rm $startdir/pkg/usr/lib/madman/plugins/.sconsign
  mkdir -p $startdir/pkg/usr/share/{applications,icons}
  mkdir -p $startdir/pkg/usr/share/icons/{mini,large}

  cp $startdir/src/madman_logo.png $startdir/pkg/usr/share/icons
  cp $startdir/src/madman_logo_mini.png $startdir/pkg/usr/share/icons/mini
  cp $startdir/src/madman_logo_large.png $startdir/pkg/usr/share/icons/large
  cp $startdir/src/madman.desktop $startdir/pkg/usr/share/applications
}
