# Maintainer: Felix Yan <felixonmars@archlinux.org>
# Contributor: Josip Ponjavic <josipponjavic at gmail dot com>
# Contributor: Xu Fasheng <fasheng.xu[AT]gmail.com>

pkgname=deepin-qt-dbus-factory
pkgver=5.5.5
pkgrel=3
pkgdesc='A repository stores auto-generated Qt5 dbus code (libdframeworkdbus)'
arch=('x86_64')
url="https://github.com/linuxdeepin/dde-qt-dbus-factory"
license=('GPL3')
depends=('qt5-base')
makedepends=('dtkcore' 'python')
source=("$pkgname-$pkgver.tar.gz::https://github.com/linuxdeepin/dde-qt-dbus-factory/archive/$pkgver.tar.gz"
        https://github.com/linuxdeepin/dde-qt-dbus-factory/commit/ff8fa559c7a8fe5605789a7fb69769fdf2c1a608.patch)
sha512sums=('b3c9619774db15ae1c2d795cc1f77181e44220359256059e3be6af155d9763dde8ae56bb4d2ab263d0e4cff2036488e770c8cddcb04d55eb2041b4f973bffd31'
            '91aafe5fc68ef404059a0b31cfe99687c2ca7513e8db0a86fbac3cbe3453ce7d3da348025524da2682db1b9af1c2a2a9f7fb5f9ba04788ddb0e79d6987b9292f')

prepare() {
  # dde-session-shell needs unreleased api
  patch -d dde-qt-dbus-factory-$pkgver -p1 < ff8fa559c7a8fe5605789a7fb69769fdf2c1a608.patch
}

build() {
  cd dde-qt-dbus-factory-$pkgver
  qmake-qt5 PREFIX=/usr
  make
}

package() {
  cd dde-qt-dbus-factory-$pkgver
  make INSTALL_ROOT="$pkgdir" install
}
