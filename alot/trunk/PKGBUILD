# Maintainer: Daniel M. Capella <polyzen@archlinux.org>
# Contributor: Mark Foxwell <fastfret79@archlinux.org.uk>
# Contributor: Nicolas Pouillard [https://nicolaspouillard.fr]
# Contributor: seschwar -- contact via Arch Linux forum or AUR
# Contributor: Ian Denhardt <ian@zenhack.net>

pkgname=alot
pkgver=0.8
pkgrel=2
pkgdesc='Terminal-based MUA for the notmuch mail system'
arch=(any)
url=https://github.com/pazz/alot
license=('GPL3')
depends=('desktop-file-utils' 'notmuch' 'python-configobj' 'python-gpgme'
         'python-magic' 'python-setuptools' 'python-twisted' 'python-urwid'
         'python-urwidtrees')
makedepends=('python-sphinx')
checkdepends=('python-mock')
source=("$url/archive/$pkgver/alot-$pkgver.tar.gz")
sha512sums=('3013e48b6c751bb7c52c440e8500d91addb3e3bdfc37f386cad63254490c4eb93aedca1005df06b25783277df67b8d329cc03329e9a8a1e3bbb70c055d90283d')

# The Arch Linux package python-magic's egg calls itself "file-magic",
# as opposed to the python-magic on PyPI.
prepare() {
  cd alot-$pkgver
  sed -i 's/python-magic/file-magic/' setup.py
}

build() {
  cd alot-$pkgver
  python setup.py build
  make -C docs man
}

check() {
  cd alot-$pkgver
  python setup.py test
}

package() {
  cd alot-$pkgver
  python setup.py install --optimize=1 --root="$pkgdir" --skip-build
  install -Dm644 -t "$pkgdir"/usr/share/man/man1 docs/build/man/alot.1
  install -Dm644 -t "$pkgdir"/usr/share/applications extra/alot*.desktop
  install -Dm644 extra/completion/alot-completion.zsh \
    "$pkgdir"/usr/share/zsh/functions/_alot
  install -Dm644 -t "$pkgdir"/usr/share/alot/themes \
    extra/themes/{mutt,solarized_light,solarized_dark,sup,tomorrow}
}

# vim:set ts=2 sw=2 et:
