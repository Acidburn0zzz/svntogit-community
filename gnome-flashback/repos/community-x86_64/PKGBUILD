# $Id$
# Maintainer: Balló György <ballogyor+arch at gmail dot com>

pkgname=gnome-flashback
pkgver=3.20.0
pkgrel=3
pkgdesc="GNOME Flashback session"
arch=('i686' 'x86_64')
url="https://wiki.gnome.org/Projects/GnomeFlashback"
license=('GPL')
depends=('gnome-bluetooth' 'gnome-panel' 'gnome-session' 'gnome-settings-daemon' 'gnome-themes-standard' 'libibus' 'metacity' 'nautilus')
makedepends=('intltool')
optdepends=('gnome-backgrounds: Default background'
            'gnome-control-center: System settings'
            'gnome-screensaver: Lock screen'
            'network-manager-applet: Network management')
install=$pkgname.install
source=(https://download.gnome.org/sources/$pkgname/${pkgver%.*}/$pkgname-$pkgver.tar.xz
        git-fixes.patch
        fix-theme.patch)
sha256sums=('0f065d8eb7ad8939734bab551cde39ddf327ada54ff38c32737f2f29dd7111c9'
            'c7b09e506fbe7baa181cde8e52f3e135f76cdc587e0d8f6af7562f4987c2607d'
            '5fc12caeb38f4bbeffd2679397d62aa0e300464cbf88726d4b04d279742fa481')

prepare() {
  cd $pkgname-$pkgver

  # Apply some fixes from git
  patch -Np1 -i ../git-fixes.patch

  # Small theme improvements
  # https://bugzilla.gnome.org/show_bug.cgi?id=764857
  patch -Np1 -i ../fix-theme.patch
}

build() {
  cd $pkgname-$pkgver
  ./configure --prefix=/usr --sysconfdir=/etc --localstatedir=/var --libexecdir=/usr/lib/$pkgname \
              --disable-schemas-compile
  make
}

package() {
  cd $pkgname-$pkgver
  make DESTDIR="$pkgdir" install
}
