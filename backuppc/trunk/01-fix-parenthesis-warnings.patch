# http://svnweb.mageia.org/packages/cauldron/backuppc/current/SOURCES/BackupPC-3.2.1-CVE-2011-170886.diff?view=markup

--- a/lib/BackupPC/Storage/Text.pm	2011-04-25 05:31:55.000000000 +0200
+++ b/lib/BackupPC/Storage/Text.pm	2011-11-28 17:25:44.579141456 +0100
@@ -299,5 +299,5 @@
     # Promote BackupFilesOnly and BackupFilesExclude to hashes
     #
-    foreach my $param qw(BackupFilesOnly BackupFilesExclude) {
+    foreach my $param ( qw(BackupFilesOnly BackupFilesExclude) ) {
         next if ( !defined($conf->{$param}) || ref($conf->{$param}) eq "HASH" );
         $conf->{$param} = [ $conf->{$param} ]
--- a/lib/BackupPC/Lib.pm	2011-04-25 05:31:55.000000000 +0200
+++ b/lib/BackupPC/Lib.pm	2011-11-28 17:28:01.830700902 +0100
@@ -1410,5 +1410,5 @@
     $conf->{$shareName} = [ $conf->{$shareName} ]
                     if ( ref($conf->{$shareName}) ne "ARRAY" );
-    foreach my $param qw(BackupFilesOnly BackupFilesExclude) {
+    foreach my $param ( qw(BackupFilesOnly BackupFilesExclude) ) {
         next if ( !defined($conf->{$param}) );
         if ( ref($conf->{$param}) eq "HASH" ) {
