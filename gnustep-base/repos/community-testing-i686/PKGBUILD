# $Id$
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Maintainer: Vesa Kaihlavirta <vegai@iki.fi>
# Contributor: Sebastian Sareyko <public@nooms.de>

pkgname=gnustep-base
pkgver=20110407
pkgrel=1
pkgdesc="The GNUstep base package"
arch=('i686' 'x86_64')
url="http://www.gnustep.org/"
license=("GPL" "LGPL")
depends=(libxslt avahi gmp gcc-libs openssl libffi gnustep-make gnutls)
makedepends=(gcc-objc)
conflicts=('gnustep-base-svn')
groups=('gnustep-core')
options=('!emptydirs' '!makeflags')
#source=(ftp://ftp.gnustep.org/pub/gnustep/core/$pkgname-$pkgver.tar.gz)
source=(http://arch.p5n.pp.ru/~sergej/dl/gnustep/$pkgname-$pkgver.tar.xz)
md5sums=('16e4012a0ac0967157ded1b803be21dc')

build() {
  cd $srcdir/$pkgname-$pkgver
  source /etc/profile.d/GNUstep.sh
  # need this stupid hack
  mkdir -p $pkgdir/opt/GNUstep/System/Library/Libraries/Resources/gnustep-base/NSTimeZones
  ./configure --prefix=/opt/GNUstep --with-ffi-include=/usr/lib/libffi-3.0.9/include/
  # fix file ownership
  sed -i 's/tar -xf $(TIMEZONE_ARCHIVE);/tar -xf $(TIMEZONE_ARCHIVE);chown -R root:root * ;/' NSTimeZones/Makefile.postamble
  make VERBOSE=1
  make DESTDIR=$pkgdir install
  chown -R root.root $pkgdir/
}
