# $Id: PKGBUILD,v 1.7 2009/07/14 15:48:38 spupykin Exp $

pkgname=fltk2
pkgver=2.0
_pkgver=2.0.x-r6793
pkgrel=3
pkgdesc="Graphical user interface toolkit for X"
arch=(i686 x86_64)
license=('LGPL')
url="http://www.fltk.org/"
depends=('libjpeg' 'libpng' 'gcc-libs' 'libxft' 'libxext')
makedepends=('mesa')
source=(http://ftp.funet.fi/pub/mirrors/ftp.easysw.com/pub/fltk/snapshots/fltk-${_pkgver}.tar.bz2)
md5sums=('3e413b2063bdb3d1a6ad4832458d885d')

build() {
  cd $startdir/src/fltk-${_pkgver}
  [ $NOEXTRACT -eq 1 ] || ./configure --prefix=/usr --enable-threads --enable-xft --enable-shared

  patch -p0 src/filename_list.cxx <<EOF
66c66
<   int n = scandir(d, list, 0, (int(*)(const void*,const void*))sort);
---
>   int n = scandir(d, list, 0, (int(*)(const dirent64**,const dirent64**))sort);
EOF

  make || return 1

  patch -p0 fluid/Makefile <<EOF
137c137
< 	\$(bindir)/fltk2-config --post \$(DESTDIR)\$(bindir)/fluid2\$(EXEEXT)
---
> 	\$(DESTDIR)\$(bindir)/fltk2-config --post \$(DESTDIR)\$(bindir)/fluid2\$(EXEEXT)
EOF

  make DESTDIR=$startdir/pkg install
}
