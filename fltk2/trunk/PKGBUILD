# $Id$
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>

pkgname=fltk2
pkgver=2.0
_pkgver=2.0.x-r7725
pkgrel=6
pkgdesc="Graphical user interface toolkit for X"
arch=(i686 x86_64)
license=('LGPL')
url="http://www.fltk.org/"
depends=('libjpeg' 'libpng' 'gcc-libs' 'libxft' 'libxext' 'libxi' 'libxinerama')
makedepends=('mesa')
source=(http://ftp.funet.fi/pub/mirrors/ftp.easysw.com/pub/fltk/snapshots/fltk-${_pkgver}.tar.bz2
        libpng14.patch)
md5sums=('4d2680a65574e920becf968b899d5311'
         '93955f17f56ad8b419ca1f8ea8c24a7f')

build() {
  cd $srcdir/fltk-${_pkgver}
  [ $NOEXTRACT -eq 1 ] || ./configure --prefix=/usr --enable-threads --enable-xft --enable-shared

  patch -p0 src/filename_list.cxx <<EOF
66c66
<   int n = scandir(d, list, 0, (int(*)(const void*,const void*))sort);
---
>   int n = scandir(d, list, 0, (int(*)(const dirent64**,const dirent64**))sort);
EOF

  patch -Np1 -i "$srcdir/libpng14.patch"
  make
  make DESTDIR=$pkgdir install
}
