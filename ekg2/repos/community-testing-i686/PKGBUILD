# $Id$
# Maintainer: Mateusz Herych <heniekk@gmail.com>

pkgname=ekg2
pkgver=0.3.0
pkgrel=2
pkgdesc="ncurses based Jabber, Gadu-Gadu, Tlen and IRC client"
arch=('i686' 'x86_64')
url="http://ekg2.org/"
license=('GPL')
depends=('aspell' 'libjpeg' 'python2' 'libgadu' 'gnutls' 'gpm' 'libidn' 'giflib' 'gpgme')
optdepends=( 'xosd: for xosd support'
	         'sqlite3: sqlite support'
			 'gtk2: gtk support')
provides=('ekg2-unicode')
source=(http://pl.ekg2.org/ekg2-$pkgver.tar.gz)
md5sums=('652e492fcf72281a42c3e5960347516e')

build() {
  cd $srcdir/$pkgname-$pkgver
  sed -i 's|ncursesw/ncurses.h|ncurses.h|g' configure plugins/ncurses/ecurses.h
  ./configure --prefix=/usr \
	--sysconfdir=/etc \
  	--with-libgadu \
  	--with-xosd \
	--enable-unicode \
	--enable-shared \
	--without-gpg
  make
}

package() {
  cd $srcdir/$pkgname-$pkgver
  make DESTDIR=$pkgdir install
  rm -rf $pkgdir/usr/lib/perl5/core_perl/perllocal.pod
  mv $pkgdir/usr/libexec/ioctld $pkgdir/usr/lib/ekg2/ioctld
  rm -rf $pkgdir/usr/libexec
  chmod -R 755 $pkgdir/usr/lib/perl5
}
