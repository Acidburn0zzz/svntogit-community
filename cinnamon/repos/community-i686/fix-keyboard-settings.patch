From 034f9c886a4b08e214193576b11fb97ba3d62922 Mon Sep 17 00:00:00 2001
From: Lusito <core@roughael.net>
Date: Sun, 10 Mar 2013 21:01:07 +0100
Subject: [PATCH] fix for broken keyboard settings

---
 files/usr/lib/cinnamon-settings/bin/SettingsWidgets.py |  2 +-
 files/usr/lib/cinnamon-settings/modules/cs_keyboard.py | 12 ++++++------
 2 files changed, 7 insertions(+), 7 deletions(-)

diff --git a/files/usr/lib/cinnamon-settings/bin/SettingsWidgets.py b/files/usr/lib/cinnamon-settings/bin/SettingsWidgets.py
index b8842fe..cdccf46 100644
--- a/files/usr/lib/cinnamon-settings/bin/SettingsWidgets.py
+++ b/files/usr/lib/cinnamon-settings/bin/SettingsWidgets.py
@@ -9,7 +9,7 @@
     import gettext
     from gi.repository import Gio, Gtk, GObject, Gdk
     from gi.repository import GdkPixbuf 
-#    import gconf
+    from gi.repository import GConf
     import json
     import dbus
     import time
diff --git a/files/usr/lib/cinnamon-settings/modules/cs_keyboard.py b/files/usr/lib/cinnamon-settings/modules/cs_keyboard.py
index 27a75ae..1ea8fd9 100644
--- a/files/usr/lib/cinnamon-settings/modules/cs_keyboard.py
+++ b/files/usr/lib/cinnamon-settings/modules/cs_keyboard.py
@@ -8,7 +8,7 @@
 gettext.install("cinnamon", "/usr/share/cinnamon/locale")
 
 # Keybindings page - check if we need to store custom
-# keybindings to gsettings key as well as gconf (In Mint 14 this is changed)
+# keybindings to gsettings key as well as GConf (In Mint 14 this is changed)
 CUSTOM_KEYS_BASENAME = "/org/gnome/settings-daemon/plugins/media-keys/custom-keybindings"
 CUSTOM_KEYS_SCHEMA = "org.gnome.settings-daemon.plugins.media-keys.custom-keybinding"
 CUSTOM_KEYBINDINGS_GSETTINGS = False
@@ -160,7 +160,7 @@ def __init__(self, content_box):
         first_run_completed = schema.get_boolean("custom-keybindings-to-3-6")
 
         if CUSTOM_KEYBINDINGS_GSETTINGS and not first_run_completed:
-            gclient = gconf.client_get_default()
+            gclient = GConf.Client.get_default()
             path = "/desktop/gnome/keybindings"
             subdirs = gclient.all_dirs(path)
             for subdir in subdirs:
@@ -251,7 +251,7 @@ def setBinding(self, index, val):
         self.writeSettings()
 
     def writeSettings(self):
-        gclient = gconf.client_get_default()
+        gclient = GConf.Client.get_default()
         gclient.set_string(self.path + "/name", self.label)
         gclient.set_string(self.path + "/action", self.action)
         gclient.set_string(self.path + "/binding", self.entries[0])
@@ -537,7 +537,7 @@ def loadCustoms(self):
         for category in self.main_store:
             if category.int_name is "custom":
                 category.clear()
-        gclient = gconf.client_get_default()
+        gclient = GConf.Client.get_default()
         path = "/desktop/gnome/keybindings"
         subdirs = gclient.all_dirs(path)
         for subdir in subdirs:
@@ -645,7 +645,7 @@ def onAddCustomButtonClicked(self, button):
             dialog.destroy()
             return
 
-        gclient = gconf.client_get_default()
+        gclient = GConf.Client.get_default()
         path = "/desktop/gnome/keybindings/custom"
         i = 0
         while gclient.dir_exists(path + str(i)):
@@ -670,7 +670,7 @@ def onRemoveCustomButtonClicked(self, button):
         keybindings, iter = self.kb_tree.get_selection().get_selected()
         if iter:
             keybinding = keybindings[iter][1]
-            gclient = gconf.client_get_default()
+            gclient = GConf.Client.get_default()
             if gclient.dir_exists(keybinding.path):
                 gclient.unset(keybinding.path + "/name")
                 gclient.unset(keybinding.path + "/action")
-- 
1.8.1.5
