# $Id: PKGBUILD,v 1.13 2009/07/16 02:01:32 dgriffiths Exp $
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: Sergej Pupykin <pupykin.s+arch@gmail.com>

pkgname=xf4vnc-xvnc
pkgver=20090715
pkgrel=1
pkgdesc="xf4vnc Xvnc server"
arch=(i686 x86_64)
url="http://xf4vnc.sf.net"
license=('GPL')
depends=(libxfont libxi libxmu libjpeg libxrender glproto bigreqsproto)
makedepends=(xf86driproto xcmiscproto xtrans resourceproto evieext xf86bigfontproto xorg-util-macros)
conflicts=(tightvnc)
options=('!libtool')
source=(http://ghost1227.com/files/misc/xf4vnc.cvs.$pkgver.tar.gz)
md5sums=('ed78dcabde66089038f7dce424684c2d')

build() {
  cd $startdir/src/xf4vnc.cvs/src/xserver

  [ -x ./configure ] && \
      ./configure  --prefix=/usr --with-fontdir=/usr/share/fonts --disable-glx --enable-builtin-fonts || \
      ./autogen.sh --prefix=/usr --with-fontdir=/usr/share/fonts --disable-glx --enable-builtin-fonts

  (cd dix && make) || return 1
  (cd mi && make) || return 1
  (cd os && make) || return 1
  (cd fb && make) || return 1
  (cd xfixes && make) || return 1
  (cd Xext && make) || return 1
  (cd dbe && make) || return 1
  (cd XTrap && make) || return 1
  (cd render && make) || return 1
  (cd randr && make) || return 1
  (cd damageext && make) || return 1
  (cd miext && make) || return 1
  (cd Xi && make) || return 1
  (cd xkb && make) || return 1
  (cd composite && make) || return 1
  (cd config && make) || return 1
  cd hw/vnc && make || return 1

  install -D -m0755 Xvnc $startdir/pkg/usr/bin/Xvnc
}
