From: Tom√°s Touceda <chiiph@torproject.org>
Date: Thu, 28 Jun 2012 23:55:24 +0000 (-0300)
Subject: Do not add relative root to datadirectory if it is empty
X-Git-Url: https://gitweb.torproject.org

Do not add relative root to datadirectory if it is empty
---

diff --git a/changes/bug6178 b/changes/bug6178
new file mode 100644
index 0000000..e727ed9
--- /dev/null
+++ b/changes/bug6178
@@ -0,0 +1 @@
+  o Do not add relative root to DataDirectory if it is empty. Fixes bug 6178.
diff --git a/src/vidalia/MainWindow.cpp b/src/vidalia/MainWindow.cpp
index a8dce5a..a7a4a09 100644
--- a/src/vidalia/MainWindow.cpp
+++ b/src/vidalia/MainWindow.cpp
@@ -1104,7 +1104,7 @@ MainWindow::start()
   QString dataDirectory = settings.getDataDirectory();
   QFileInfo dataDirectoryInfo(dataDirectory);
 
-  if(QDir(dataDirectory).isRelative()) {
+  if(not dataDirectory.isEmpty() and QDir(dataDirectory).isRelative()) {
     dataDirectory = QCoreApplication::applicationDirPath() + "/" + dataDirectory;
 
     QFileInfo newDataDirectoryInfo(dataDirectory);
