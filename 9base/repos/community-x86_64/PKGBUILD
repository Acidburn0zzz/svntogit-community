# $Id$
# Maintainer: Jeff Mickey <j@codemac.net>
# Contributor: Aaron, phrakture, Griffin <aaron@archlinux.org>
# Contributor: Jeffrey 'jf' Lim <jfs.world@gmail.com>

pkgname=9base
pkgver=2
pkgrel=3
pkgdesc="Port of various original Plan9 tools to unix"
url="http://suckless.org"
source=(http://code.suckless.org/dl/misc/$pkgname-$pkgver.tar.gz \
	9 config.mk plan9.sh)
conflicts=('plan9port' '9rc-devel')
provides=('plan9')
arch=('i686' 'x86_64')
license=('custom')
md5sums=('f9d30509996ec178702af20fec986e9d' 'ae7108b9f26bed388e9055f35eef2986'\
         '263eccf0bd4cca3c219379c286b00353' '62a9e52043d9c32967fcae9018fffb56')

build()
{
  cd $startdir/src/$pkgname-$pkgver
  cp -f ../config.mk .

  sed -i "s#%CFLAGS%#$CFLAGS#g" config.mk
  sed -i "s#%LDFLAGS%#$LDFLAGS -L$startdir/src/$pkgname-$pkgver/lib9#g" config.mk
  make || return 1
  make DESTDIR=$startdir/pkg install

  install -m755 ../9 $startdir/pkg/opt/plan9/bin/

  mkdir -p $startdir/pkg/etc/profile.d/
  install -m755 ../plan9.sh $startdir/pkg/etc/profile.d/

  install -D -m644 LICENSE $startdir/pkg/usr/share/licenses/9base/LICENSE
}
