# $Id: PKGBUILD,v 1.13 2009/06/11 10:31:30 sergej Exp $
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: Sergej Pupykin <pupykin.s+arch@gmail.com>

pkgname=biew
pkgver=5.7.3.1
_lver=5731
pkgrel=1
pkgdesc="Binary viewer"
arch=(i686)
license=('GPL')
depends=(slang gpm)
url="http://biew.sourceforge.net/"
options=(zipman)
source=(http://downloads.sourceforge.net/sourceforge/${pkgname}/${pkgname}-${_lver}.tar.bz2)
md5sums=('ed9b2b9b4c69e469970b9e6f88b0e74b')

build() {
  cd $startdir/src/${pkgname}-${_lver}
  ./configure --prefix=/usr
  make || return 1

  sed -i "s|PREFIX=/usr|PREFIX=$startdir/pkg/usr|" config.mak
  sed -i "s|DATADIR=/usr/share/biew|DATADIR=$startdir/pkg/usr/share/biew|" config.mak
  sed -i "s|LIBDIR=/usr/lib/biew|LIBDIR=$startdir/pkg/usr/lib/biew|" config.mak

  patch makefile <<EOF
266,267c266,266
< 	\$(INSTALL) -D -c -m 644 bin_rc/xlt/* \$(DATADIR)/xlt
< 	\$(INSTALL) -D -c -m 644 bin_rc/xlt/russian/* \$(DATADIR)/xlt/russian
---
> 	cp -r bin_rc/xlt/* \${DATADIR}/xlt
EOF

  make prefix=$startdir/pkg/usr install || return 1

  mv $pkgdir/usr/man $pkgdir/usr/share/
}
