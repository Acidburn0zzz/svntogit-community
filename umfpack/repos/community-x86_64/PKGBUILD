# $Id$
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: iKevin <kellwood at ameritech dot net>

pkgname=umfpack
pkgver=5.3.0
pkgrel=1
pkgdesc="A multifrontal direct solver for unsymmetric linear systems"
arch=('i686' 'x86_64')
url="http://www.cise.ufl.edu/research/sparse/umfpack"
license=('LGPL')
makedepends=('lapack' 'blas')
source=(http://www.cise.ufl.edu/research/sparse/umfpack/v$pkgver/UMFPACK.tar.gz \
	http://www.cise.ufl.edu/research/sparse/UFconfig/current/UFconfig.tar.gz \
        http://www.cise.ufl.edu/research/sparse/amd/current/AMD.tar.gz \
	UFconfig.mk)
md5sums=('6912026a355cac83dfc11e62e6a19fae'
         '6303726820b95821c1654b742915cd67'
         'f81fcae945de82864035b03ee20a8d2b'
         'cf6b013946072fd4ec1881e1dee25910')

build() {
  cd "$srcdir/UMFPACK"
  cp -rf "$srcdir/UFconfig/xerbla" .
  cp ../UFconfig.mk $startdir/src/UFconfig
  make library || return 1
  install -d "$pkgdir/usr/lib" "$pkgdir/usr/include"
  install -D -m644 Lib/libumfpack.a "$pkgdir/usr/lib/libumfpack.a"
  cp $startdir/src/UMFPACK/Include/*.h $startdir/pkg/usr/include
  install -D -m644 "$srcdir/AMD/Lib/libamd.a" "$pkgdir/usr/lib/libamd.a"
  cp $startdir/src/AMD/Include/*.h $startdir/pkg/usr/include
  install -m644 "$srcdir/UFconfig/UFconfig.h" "$pkgdir/usr/include" || return 1

# Fix permissions
  cd $startdir/pkg/usr/include
  chmod oug+r *
  cd $startdir/pkg/usr/lib
  chmod oug+r *
}
