# Creator: Borromini <gotleenucks at g-male dot com>
# Maintainter: Jelle van der Waa <jelle at vdwaa dot nl>

pkgname='evolution-rss'
pkgver=0.2.3
pkgrel=5
pkgdesc="This plugin implements RSS reading capability within Evolution"
arch=(i686 x86_64)
license=('GPL')
install=evolution-rss.install
url="http://gnome.eu.org/evo/index.php/Evolution_RSS_Reader_Plugin"
depends=('evolution' 'libsoup' 'libgnomecanvas')
makedepends=('intltool' 'gnome-common')
options=('!libtool' '!emptydirs')
source=(http://gnome.eu.org/$pkgname-$pkgver.tar.gz
        add-dbus-glib.patch)
md5sums=('bbf825c3655eaebadc429141a8f408d0'
         'ef16147db282739cd5218ef590b79c81')
build() {
  cd $srcdir/$pkgname-${pkgver}
  patch -Np1 -i $srcdir/add-dbus-glib.patch
  ./autogen.sh
  ./configure \
	--prefix=/usr \
	--sysconfdir=/etc \
	--localstatedir=/var \
        --with-primary-render=gtkhtml \
	--disable-schemas-install
  make
}

package() {
  cd $srcdir/$pkgname-${pkgver}
  make GCONF_DISABLE_MAKEFILE_SCHEMA_INSTALL=1 DESTDIR=$pkgdir install

  mkdir -p $pkgdir/usr/share/gconf/schemas
  gconf-merge-schema $pkgdir/usr/share/gconf/schemas/${pkgname}.schemas $pkgdir/etc/gconf/schemas/*.schemas
  rm -rf $pkgdir/etc/gconf/
}
