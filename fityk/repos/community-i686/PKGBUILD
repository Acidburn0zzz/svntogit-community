# Maintainer: Thomas Dziedzic < gostrc at gmail >
# Contributor: Anton Bazhenov <anton.bazhenov at gmail>
# Contributor: Cuneyt Unlu <unlucu AT gmail.com>

pkgname=fityk
pkgver=1.1.1
pkgrel=1
pkgdesc='A program for nonlinear fitting of analytical functions to data.'
arch=('i686' 'x86_64')
url='http://www.unipress.waw.pl/fityk/'
license=('GPL')
depends=('xylib' 'shared-mime-info' 'lua' 'gnuplot') # wxgtk supplied by statically linked wxWidgets
makedepends=('boost' 'git' 'python-sphinx' 'swig')
options=('!libtool')
install='fityk.install'
source=('http://biolpc22.york.ac.uk/pub/Daily_HEAD/wxWidgets.tar.gz') # daily snapshot because fityk requires a version that hasn't been released yet...
md5sums=('e02d7a4af1201d39e20a864cd15f530f')

build() {
  cd wxWidgets
  ./configure --prefix=${srcdir}/usr --disable-shared --with-libpng=sys --with-libxpm=sys --with-libjpeg=sys --with-libtiff=sys
  make
  make install

  cd ${srcdir}
  git clone git://github.com/wojdyr/fityk.git
  cd fityk
  git checkout v${pkgver}
  #cd ${pkgname}-${pkgver}

  # disable xyconvert because wxwidgets>=2.9 is needed (dev version) and it isn't standard with arch yet
    #--disable-xyconvert \
  ./autogen.sh \
    --prefix=/usr \
    --without-doc \
    --with-wx-prefix=${srcdir}/usr
  #./configure \

  make
}

package() {
  cd fityk

  make DESTDIR=${pkgdir} install
}
