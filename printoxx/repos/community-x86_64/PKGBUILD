# Contributor: Stefan Husmann <stefan-husmann@t-online.de>
# Maintainer: Stefan Husmann <stefan-husmann@t-online.de>

pkgname=printoxx  
pkgver=2.3.1
pkgrel=2
pkgdesc="Adjusting images on a sheet of paper for printing"
url="http://kornelix.squarespace.com/printoxx"
arch=('i686' 'x86_64')
license=('GPL2')
depends=('gtk2')
source=("http://kornelix.squarespace.com/storage/downloads/$pkgname-$pkgver.tar.gz")
md5sums=('67297306e4ddc8cfd13d90158dadef0e')

build() {
  cd $srcdir/$pkgname-$pkgver
  sed -i 's#kornelix-##' Makefile || return 1
  sed -i 's+xdg-+#xdg-+' Makefile || return 1
  sed -i 's+/usr/local+/usr+g' desktop || return 1
  LDFLAGS="-O3 -Wall -rdynamic `pkg-config --libs gtk+-2.0  gthread-2.0`" \
    PREFIX=/usr make || return 1
}

package() {
  cd $srcdir/$pkgname-$pkgver
  install -d $pkgdir/usr/share/$pkgname || return 1
  install -d $pkgdir/usr/share/applications || return 1
  make PREFIX=$pkgdir/usr menu || return 1
  make PREFIX=$pkgdir/usr install || return 1
  install -Dm644 $pkgdir/usr/share/$pkgname/$pkgname.desktop \
    $pkgdir/usr/share/applications/$pkgname.desktop || return 1
  rm $pkgdir/usr/share/$pkgname/$pkgname.desktop 
  install -Dm644 $pkgdir/usr/share/doc/$pkgname/$pkgname.man \
    $pkgdir/usr/share/man/man1/$pkgname.1 || return 1
  rm $pkgdir/usr/share/doc/$pkgname/$pkgname.man 
}

