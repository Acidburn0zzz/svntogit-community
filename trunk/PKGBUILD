# Maintainer: Jelle van der Waa <jelle@archlinux.org>
# Contributor: kevku <kevku@gmx.com>

pkgname=geckodriver
pkgver=0.25.0
pkgrel=1
pkgdesc="Proxy for using W3C WebDriver-compatible clients to interact with Gecko-based browsers."
arch=("x86_64")
url="https://github.com/mozilla/geckodriver"
license=("MPL")
makedepends=("rust" "cargo" "gcc-libs")
source=("https://github.com/mozilla/geckodriver/archive/v$pkgver.tar.gz")
sha256sums=('9ba9b1be1a2e47ddd11216ce863903853975a4805e72b9ed5da8bcbcaebbcea9')

build() {
	cd "$pkgname-$pkgver"
        # FIXME: upstream does not provide Cargo.lock https://github.com/mozilla/geckodriver/issues/1403
	cargo build --release #--locked
}

package() {
	cd "$pkgname-$pkgver"
        install -Dm755 target/release/$pkgname "$pkgdir"/usr/bin/$pkgname
        ln -sf /usr/bin/$pkgname "$pkgdir"/usr/bin/wires
}
