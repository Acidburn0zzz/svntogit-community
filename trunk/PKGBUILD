# $Id$
# Maintainer: Laurent Carlier <lordheavym@gmail.com>
# Contributor: Luca Bennati <lucak3 AT gmail DOT com>
# Contributor: Glaucous <glakke1 at gmail dot com>

pkgname=apitrace
pkgver=3.0
pkgrel=1
pkgdesc="Graphics API Tracing"
arch=('i686' 'x86_64')
url="https://github.com/apitrace/apitrace"
license=('BSD')
depends=('python2' 'libgl')
makedepends=('cmake>=2.8' 'mesa')
optdepends=('qt: GUI support' 'qjson: GUI support')
source=("https://github.com/apitrace/$pkgname/zipball/$pkgver"
	gcc-4.7-fix.patch)
#	LICENSE)

build() {
  cd ${srcdir}/apitrace-*

  # Merged upstream
  patch -Np1 -i ${srcdir}/gcc-4.7-fix.patch

  cmake . -Bbuild -DCMAKE_INSTALL_PREFIX=/usr -DPYTHON_EXECUTABLE='/usr/bin/python2'
  make -C build
}

package() {
  cd ${srcdir}/apitrace-*

  make -C build DESTDIR="${pkgdir}/" install

#  mkdir -p "${pkgdir}"/usr/share/licenses/apitrace
#  mv "${pkgdir}"/usr/share/{doc,licenses}/apitrace/LICENSE
}

