# Maintainer: Peter Lewis <plewis@aur.archlinux.org>
# Contributor: linuxSEAT <--put_my_name_here--@gmail.com>
# Contributor: Le_J <clej37 at gmail dot com>

pkgname=ktikz
pkgver=0.10
pkgrel=1
pkgdesc="A small application helping you to create TikZ diagrams (from the LaTeX pgf package)"
arch=('i686' 'x86_64')
url="http://www.hackenberger.at/blog/ktikz-editor-for-the-tikz-language/"
license="GPL"
depends=('poppler-qt' 'kdelibs')
makedepends=('automoc4' 'cmake')
source=("http://www.hackenberger.at/ktikz/"$pkgname"_"$pkgver".tar.gz")
md5sums=('e8f0826cba2447250bcdcd389a71a2ac')

build() {
    cd "$srcdir"/"$pkgname"
    
    # Patch conf.pri to get rid of annoying environment variables
    egrep -v '^(DESKTOPDIR|PREFIX)' conf.pri > conf.pri.patched 
    mv -f conf.pri.patched conf.pri 

    sed -e 's/LRELEASECOMMAND/#LRELEASECOMMAND/' conf.pri > conf.pri.patched
    mv -f conf.pri.patched conf.pri 

    sed -e 's/QMAKECOMMAND/#QMAKECOMMAND/' conf.pri > conf.pri.patched
    mv -f conf.pri.patched conf.pri 

    # Make and install
    cmake -DCMAKE_INSTALL_PREFIX=`kde4-config --prefix`
    make 
}

package() {
    cd "$srcdir"/"${pkgname}"
    make DESTDIR="$pkgdir" install
}
