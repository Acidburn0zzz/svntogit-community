# $Id$
# Maintainer: Brad Fanella <bradfanella@archlinux.us>
# Contributor: SpepS <dreamspepser at yahoo dot it>
# Contributor: Jeff Mickey <jeff@archlinux.org>
# Contributor: tardo <tardo@nagi-fanboi.net>

pkgname=chuck
pkgver=1.2.1.3
pkgrel=4
pkgdesc="Concurrent, on-the-fly audio programming language."
arch=('i686' 'x86_64')
url="http://chuck.cs.princeton.edu/"
license=('GPL')
source=(http://chuck.cs.princeton.edu/release/files/$pkgname-$pkgver.tgz)
md5sums=('ac8459b4067c2491fbdeb61d122a5985')

if [[ $CARCH == i686 ]]; then
	depends=('gcc-libs' 'libsndfile')
	makedepends=('bison' 'flex')
	build() {
  		cd $srcdir/$pkgname-$pkgver/src
  		CFLAGS="$CFLAGS -fno-strict-aliasing"
	
		# This can be linux-alsa linux-jack linux-oss osx win32
		make linux-alsa
	}
	

else
	depends=('lib32-gcc-libs' 'lib32-libsndfile')
	makedepends=('gcc-multilib' 'bison' 'flex')
	build() {
		export CC='gcc -m32'
		export CXX='g++ -m32'

		cd $srcdir/$pkgname-$pkgver/src
		CFLAGS="$CFLAGS -fno-strict-aliasing"

  		# This can be linux-alsa linux-jack linux-oss osx win32
  		make linux-alsa
	}
	
fi

package() {
	cd $srcdir/$pkgname-$pkgver/src
	install -D -m 755 chuck $pkgdir/usr/bin/chuck
}
