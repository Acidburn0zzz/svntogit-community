# $Id$
# Maintainer: Sven-Hendrik Haase <sh@lutzhaase.com>
# Contributor: DuGi <dugi@irc.pl>

pkgname=springlobby
pkgver=0.157
pkgrel=1
pkgdesc="A free cross-platform lobby client for the Spring RTS project."
arch=('i686' 'x86_64')
url="http://springlobby.info/"
license=('GPL2')
depends=('hicolor-icon-theme' 'wxgtk' 'curl' 'libtorrent-rasterbar' 'boost-libs' 'alure')
optdepends=('sdl' 'sdl_sound' 'sdl_mixer') 
makedepends=('boost' 'asio' 'cmake')
install=springlobby.install
source=(http://www.springlobby.info/tarballs/${pkgname}-${pkgver}.tar.bz2)
md5sums=('2771aeee0eaff69218d5abc0e9cc18de')

build() {
  cd $srcdir/${pkgname}-$pkgver

  # We always use multithreaded boost libs in Arch with no special prefix but lesser
  # distros have that prefix so this check fails.
  sed -i 's/ .*-mt//g' $srcdir/$pkgname-$pkgver/src/lsl/src/lsl/CMakeLists.txt
  sed -i 's/ .*-mt//g' $srcdir/$pkgname-$pkgver/src/lsl/src/lslutils/CMakeLists.txt

  cmake . \
    -DCMAKE_INSTALL_PREFIX=/usr
  make 
}

package() {
  cd $srcdir/${pkgname}-$pkgver

  make DESTDIR=$pkgdir install

  # these conflict with files in the spring package
  rm $pkgdir/usr/include/spring/Downloader/pr-downloader.h
  rm $pkgdir/usr/lib/libpr-downloader_static.a
  rm $pkgdir/usr/lib/pkgconfig/libspringdownloader.pc
}

# vim: sw=2:ts=2 et:
