# $Id$
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Maintainer: Todd Musall <tmusall@comcast.net>

pkgname=apcupsd
pkgver=3.14.9
pkgrel=2
pkgdesc="Apcupsd can be used for power mangement and controlling most of APC's UPS models on Unix and Windows machines."
arch=(i686 x86_64)
url="http://www.apcupsd.org"
license=('GPL')
depends=('gcc-libs')
optdepends=('gd: for CGI'
	    'gconf: for frontend'
	    'gtk2: for frontend')
makedepends=('pkgconfig' 'gd' 'gconf' 'gtk2')
backup=(etc/apcupsd/apcupsd.conf etc/apcupsd/hosts.conf
        etc/apcupsd/multimon.conf)
source=(http://downloads.sourceforge.net/apcupsd/$pkgname-$pkgver.tar.gz
	apcupsd)
md5sums=('aa5e2c2954a81c2f07e0a356e38fe853'
         '8bc674da24188c69b0ad5d7fe7510f73')

build() {
  cd $srcdir/$pkgname-$pkgver
  ./configure --prefix=/usr  --libexecdir=/usr/lib/$pkgname \
		--enable-cgi --enable-usb --enable-net \
		--with-upstype=usb --with-upscable=usb \
		--with-serial-dev=/dev/usb/hid/hiddev[0-9] \
		--enable-pthreads --enable-gapcmon
  make
  make DESTDIR=$pkgdir install
  install -D -m755 ../apcupsd $pkgdir/etc/rc.d/apcupsd
  chmod 755 $pkgdir/sbin/*
  mkdir -p $pkgdir/usr/lib/$pkgname/cgi-bin
  mv $pkgdir/etc/apcupsd/*.cgi $pkgdir/usr/lib/$pkgname/cgi-bin
}
