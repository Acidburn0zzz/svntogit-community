From 60b595356b8c049adc296deb0ffe65b357500ab4 Mon Sep 17 00:00:00 2001
From: Andreas Hilboll <andreas@hilboll.de>
Date: Tue, 5 Jan 2016 12:13:15 +0100
Subject: [PATCH] BUG: allow non-root installation on linux

fixes #1607
---
 setup.py | 5 +++++
 1 file changed, 5 insertions(+)
 mode change 100644 => 100755 setup.py

diff --git a/setup.py b/setup.py
old mode 100644
new mode 100755
index 117a7ba..943f572
--- a/setup.py
+++ b/setup.py
@@ -17,6 +17,11 @@
 
 if platform.system() in ['Linux', 'FreeBSD', 'DragonFly']:
     usr_share = os.path.join(sys.prefix, "share")
+    if not os.access(usr_share, os.W_OK):
+        if 'XDG_DATA_HOME' in os.environ.keys():
+            usr_share = os.environ['$XDG_DATA_HOME']
+        else:
+            usr_share = os.path.expanduser('~/.local/share')
     data_files += [
         (os.path.join(usr_share, 'applications/'), ['electrum.desktop']),
         (os.path.join(usr_share, 'pixmaps/'), ['icons/electrum.png'])
