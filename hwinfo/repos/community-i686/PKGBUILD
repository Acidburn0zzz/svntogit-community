# $Id$
# Maintainer: Kaiting Chen <kaitocracy@gmail.com>
# Contributor: Gergely Imreh <imrehgATgmailDOTcom>
# Originally contributed by champus, madeye, Ranguvar and ninja_pt

pkgname=hwinfo
pkgver=18.1
_pkgver=$pkgver-3.5
pkgrel=9
pkgdesc='The hardware detection tool from openSUSE'
arch=('i686' 'x86_64')
url='http://www.opensuse.org/'
license=('GPL2')
depends=('perl' 'libx86emu')
makedepends=('sysfsutils' 'rpmextract' 'flex')
source=("http://download.opensuse.org/source/factory/repo/oss/suse/src/$pkgname-$_pkgver.src.rpm"
        'kbd.patch')
md5sums=('17c2a703643d1f007859c5e743589bb8'
         '1500ecfa26f6aaf4d7967eea74e86e5d')

build() {
  cd "${srcdir}"
  rpmextract.sh "${pkgname}-${_pkgver}.src.rpm"
  tar -xjf $pkgname-$pkgver.tar.bz2
  cd "${srcdir}/${pkgname}-${pkgver}"

# Apply patch for custom ioctl
  patch -p 0 < ../kbd.patch

  make -j1 LIBDIR=/usr/lib
  make LIBDIR=/usr/lib DESTDIR=$pkgdir install
}
