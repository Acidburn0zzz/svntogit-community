# $Id$
# Maintainer:  Thorsten TÃ¶pper <atsutane-tu@freethoughts.de>
# Contributor: SpepS <dreamspepser at yahoo dot it>
# Contributor: Tobias Powalowski <tpowa@archlinux.org>

_extramodules=extramodules-3.2-ARCH
_kver="$(cat /lib/modules/${_extramodules}/version)"
pkgname=ndiswrapper
pkgver=1.57
pkgrel=3
pkgdesc="Module for NDIS (Windows Network Drivers) drivers supplied by vendors."
license=('GPL')
arch=('i686' 'x86_64')
url="http://ndiswrapper.sourceforge.net"
install=ndiswrapper.install
depends=('linux>=3.2' 'linux<3.3' 'wireless_tools' 'perl')
makedepends=('linux-headers')
provides=("$pkgname-utils" "$pkgname-bin")
replaces=("$pkgname-utils" "$pkgname-bin")
source=("http://downloads.sourceforge.net/sourceforge/$pkgname/$pkgname-$pkgver.tar.gz")
options=('!strip')
md5sums=('7a401dc540938bf07893c67f418b6152')

build() {
  cd "$srcdir/$pkgname-$pkgver"

  make KVERS=$_kver
}

package() {
  cd "$srcdir/$pkgname-$pkgver"

  make INST_DIR="$pkgdir/lib/modules/$_extramodules" \
       KVERS=$_kver DIST_DESTDIR="" DESTDIR="$pkgdir" install

  rm -rf "$pkgdir/build"
  gzip "driver/ndiswrapper.ko"
  install -Dm 644 "driver/ndiswrapper.ko.gz" \
    "$pkgdir/lib/modules/$_extramodules/ndiswrapper.ko.gz"
}

# vim:set ts=2 sw=2 et:
