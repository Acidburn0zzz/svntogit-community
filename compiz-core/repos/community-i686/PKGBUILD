# $Id$
# Maintainer: Ronald van Haren <ronald.archlinux.org>
# Contributor: Hussam Al-Tayeb ht990332@gmail.com
# Contributor: Khashayar Naderehvandi <khashayar [at] naderehvandi [dot] net>
# Contributor: JJDaNiMoTh <jjdanimoth.aur@gmail.com>

pkgname=compiz-core
pkgver=0.8.4
pkgrel=3
pkgdesc="Composite manager for Aiglx and Xgl"
url="http://www.go-compiz.org/"
license=('GPL' 'LGPL' 'MIT')
arch=('i686' 'x86_64')
groups=('compiz' 'compiz-kde' 'compiz-gtk' 'compiz-fusion')
depends=('startup-notification' 'librsvg' \
         'libgl' 'dbus' 'mesa' 'libxslt' 'fuse')
makedepends=('intltool')
options=(!libtool !emptydirs)
conflicts=('compiz' 'compiz-core-git' 'compiz-git')
replaces=('compiz')
source=(http://releases.compiz.org/0.8.4/compiz-$pkgver.tar.gz
	libpng14.patch)
md5sums=('a4abe23a3f58b79a6706401aae426845'
         '5f8cb4c084cca21d3e4ab5fcc4cbaacb')
build()
{
  cd $srcdir/compiz-$pkgver

  patch -Np1 -i $srcdir/libpng14.patch || return 1
  ./configure   --prefix=/usr \
	    --disable-gnome \
	    --disable-gtk \
	    --disable-metacity \
	    --disable-gconf \
            --with-gconf-schema-file-dir=/etc/gconf/schemas \
	    --enable-dbus \
	    --enable-librsvg \
	    --disable-kde \
	    --disable-kde4

  make || return 1
  make DESTDIR=$pkgdir install

# install MIT license
install -Dm644 $srcdir/compiz-$pkgver/COPYING.MIT \
	$pkgdir/usr/share/licenses/$pkgname/COPYING.MIT
}

