Fix FS#25669

Upstream bug: http://trac.filezilla-project.org/ticket/7742

diff --git a/src/engine/tlssocket.cpp b/src/engine/tlssocket.cpp
index e9a5105..7ddb1ae 100644
--- a/src/engine/tlssocket.cpp
+++ b/src/engine/tlssocket.cpp
@@ -97,7 +97,7 @@ bool CTlsSocket::Init()
 		return false;
 	}
 
-	res = gnutls_priority_set_direct(m_session, "SECURE256:+CTYPE-X509:-CTYPE-OPENPGP", 0);
+	res = gnutls_priority_set_direct(m_session, "NORMAL:+CTYPE-X509:-CTYPE-OPENPGP", 0);
 	if (res)
 	{
 		LogError(res);
@@ -113,7 +113,9 @@ bool CTlsSocket::Init()
 	gnutls_transport_set_push_function(m_session, PushFunction);
 	gnutls_transport_set_pull_function(m_session, PullFunction);
 	gnutls_transport_set_ptr(m_session, (gnutls_transport_ptr_t)this);
+#if GNUTLS_VERSION_MAJOR < 3
 	gnutls_transport_set_lowat(m_session, 0);
+#endif
 
 	m_shutdown_requested = false;
 
