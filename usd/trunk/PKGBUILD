# Maintainer: Sven-Hendrik Haase <svenstaro@gmail.com>
# Contributor: bartus <arch-user-repoá˜“bartus.33mail.com>
pkgname=usd
pkgver=20.11
pkgrel=1
pkgdesc="3D VFX pipeline interchange file format"
arch=('x86_64')
url="https://graphics.pixar.com/usd/docs/index.html"
license=('Apache')
depends=('boost-libs' 'glew' 'openexr' 'opensubdiv')
makedepends=('boost' 'cmake' 'intel-tbb' 'ninja')
provides=("usd=${pkgver}")
source=("$pkgname-$pkgver.tar.gz::https://github.com/PixarAnimationStudios/USD/archive/v${pkgver}.tar.gz")
        # "boost_python2.patch"
        # "blender.patch")
sha256sums=('adbdf451a10a7af201b0fafa44ebc27cc2c3b412d3dbbd90f1a9319abe2e203d')

# prepare() {
#   git -C USD apply -v "${srcdir}"/{boost_python2,blender}.patch
# }

build() {
  cd USD-${pkgver}
  cmake \
    -B build \
    -G Ninja \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DPXR_USE_PYTHON_3=ON \
    -DPXR_BUILD_IMAGING=OFF
    # -DPXR_BUILD_TESTS=ON
    # -DBUILD_SHARED_LIBS=ON \
    # -DCMAKE_DEBUG_POSTFIX=_d
  ninja -C build
}

check() {
  cd USD-${pkgver}
  ninja -C build test
}

package() {
  cd USD-${pkgver}
  DESTDIR="$pkgdir" ninja -C build install
}

# vim:set ts=2 sw=2 et:
